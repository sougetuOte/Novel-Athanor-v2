<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UI操作ガイド - Novel-Athanor-v2</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <div class="presentation">

    <!-- Slide 1: Title -->
    <section class="slide slide-title active" data-slide="1">
      <h1>UI操作ガイド</h1>
      <p class="subtitle">Novel-Athanor-v2</p>
      <p class="tagline">コマンドで創作をコントロール</p>
    </section>

    <!-- Slide 2: Environment -->
    <section class="slide" data-slide="2">
      <h2>操作環境</h2>
      <p>Claude Code と Obsidian の連携で創作を管理</p>

      <div class="env-diagram">
        <div class="env-box claude-code">
          <div class="env-icon">💻</div>
          <div class="env-name">Claude Code</div>
          <p style="font-size:0.85rem;color:var(--text-muted);margin-top:0.5rem">コマンド実行<br>AI との対話</p>
        </div>
        <span class="env-arrow">↔</span>
        <div class="env-box obsidian">
          <div class="env-icon">📝</div>
          <div class="env-name">Obsidian</div>
          <p style="font-size:0.85rem;color:var(--text-muted);margin-top:0.5rem">設定ファイル編集<br>執筆内容の確認</p>
        </div>
        <span class="env-arrow">↔</span>
        <div class="env-box vault">
          <div class="env-icon">📁</div>
          <div class="env-name">Vault</div>
          <p style="font-size:0.85rem;color:var(--text-muted);margin-top:0.5rem">作品データ<br>設定ファイル</p>
        </div>
      </div>

      <div class="card" style="margin-top:2rem">
        <h3>基本的な流れ</h3>
        <ol>
          <li>Claude Code でコマンドを実行</li>
          <li>AIが処理を実行</li>
          <li>結果がVaultに保存される</li>
          <li>Obsidian で内容を確認・編集</li>
        </ol>
      </div>
    </section>

    <!-- Slide 3: Command System -->
    <section class="slide" data-slide="3">
      <h2>コマンド体系</h2>
      <p><code>/athanor</code> を中心としたシンプルな構造</p>

      <div class="terminal">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <span class="terminal-title">Claude Code</span>
        </div>
        <div class="terminal-body">
          <span class="terminal-prompt">$</span> <span class="terminal-command">/athanor [サブコマンド]</span>
        </div>
      </div>

      <div class="content-grid" style="margin-top:1.5rem">
        <div class="command-card athanor">
          <div class="command-name">/athanor draft</div>
          <div class="command-desc">下書きを生成（The Relay 実行）</div>
        </div>
        <div class="command-card athanor">
          <div class="command-name">/athanor status</div>
          <div class="command-desc">伏線ダッシュボードを表示</div>
        </div>
        <div class="command-card athanor">
          <div class="command-name">/athanor quality</div>
          <div class="command-desc">品質レポートを生成</div>
        </div>
        <div class="command-card athanor">
          <div class="command-name">/athanor resume</div>
          <div class="command-desc">中断状態から再開</div>
        </div>
        <div class="command-card athanor">
          <div class="command-name">/athanor rollback</div>
          <div class="command-desc">チェックポイントに復旧</div>
        </div>
        <div class="command-card athanor">
          <div class="command-name">/athanor switch {作品}</div>
          <div class="command-desc">作品を切り替え</div>
        </div>
      </div>
    </section>

    <!-- Slide 4: Phase Commands -->
    <section class="slide" data-slide="4">
      <h2>フェーズ管理コマンド</h2>
      <p>創作のフェーズを切り替えます</p>

      <div class="content-grid">
        <div class="command-card phase">
          <div class="command-name">/planning</div>
          <div class="command-desc">PLANNINGフェーズを開始<br>企画・設計モードに切り替え</div>
        </div>
        <div class="command-card phase">
          <div class="command-name">/building</div>
          <div class="command-desc">BUILDINGフェーズを開始<br>執筆モードに切り替え</div>
        </div>
        <div class="command-card phase">
          <div class="command-name">/auditing</div>
          <div class="command-desc">AUDITINGフェーズを開始<br>レビューモードに切り替え</div>
        </div>
      </div>

      <div class="terminal" style="margin-top:2rem">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <span class="terminal-title">使用例</span>
        </div>
        <div class="terminal-body">
          <span class="terminal-prompt">$</span> <span class="terminal-command">/building</span>
          <div class="terminal-output">
            <span class="terminal-success">✓</span> BUILDINGフェーズに切り替えました<br>
            現在のタスク: 第3話の執筆<br>
            伏線アラート: 2件
          </div>
        </div>
      </div>
    </section>

    <!-- Slide 5: Draft Command -->
    <section class="slide" data-slide="5">
      <h2>下書き生成</h2>
      <p><code>/athanor draft</code> で The Relay を実行</p>

      <div class="terminal">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <span class="terminal-title">下書き生成の例</span>
        </div>
        <div class="terminal-body">
          <span class="terminal-prompt">$</span> <span class="terminal-command">/athanor draft</span>
          <div class="terminal-output">
            <span class="terminal-highlight">▶ Continuity Director</span> コンテキスト構築中...<br>
            <span class="terminal-highlight">▶ Ghost Writer</span> 下書き生成中...<br>
            <span class="terminal-highlight">▶ Reviewer</span> 漏洩チェック中...<br>
            <span class="terminal-success">✓</span> 承認<br>
            <span class="terminal-highlight">▶ Quality Agent</span> 品質評価中...<br>
            <br>
            <span class="terminal-success">━━━ 完了 ━━━</span><br>
            品質スコア: 0.75 (良好)<br>
            出力先: vault/作品名/episodes/ep003.md
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:1.5rem">
        <h3>オプション</h3>
        <table>
          <tr><th>オプション</th><th>説明</th></tr>
          <tr><td><code>--scene {ID}</code></td><td>特定のシーンを指定</td></tr>
          <tr><td><code>--words {数}</code></td><td>目標文字数を指定</td></tr>
        </table>
      </div>
    </section>

    <!-- Slide 6: Status Command -->
    <section class="slide" data-slide="6">
      <h2>伏線ダッシュボード</h2>
      <p><code>/athanor status</code> で伏線の状態を確認</p>

      <div class="terminal">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <span class="terminal-title">伏線ダッシュボード</span>
        </div>
        <div class="terminal-body">
          <span class="terminal-prompt">$</span> <span class="terminal-command">/athanor status</span>
          <div class="terminal-output">
            <span class="terminal-highlight">━━━ 伏線ダッシュボード ━━━</span><br>
            <br>
            <span style="color:#fbbf24">⚠ アラート (2件)</span><br>
            ・FS-003: 第5話までに設置が必要<br>
            ・FS-007: 強化タイミング（推奨）<br>
            <br>
            <span style="color:#60a5fa">登録済み (3件)</span><br>
            ・FS-001: 主人公の過去<br>
            ・FS-002: 謎の手紙<br>
            ・FS-008: 師匠の正体<br>
            <br>
            <span style="color:#a78bfa">設置済み (2件)</span><br>
            ・FS-003: 古い写真<br>
            ・FS-004: 壊れた時計<br>
            <br>
            <span style="color:#4ade80">回収済み (1件)</span><br>
            ・FS-005: 約束の言葉
          </div>
        </div>
      </div>
    </section>

    <!-- Slide 7: Quality Command -->
    <section class="slide" data-slide="7">
      <h2>品質レポート</h2>
      <p><code>/athanor quality</code> で品質を詳細に確認</p>

      <div class="terminal">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <span class="terminal-title">品質レポート</span>
        </div>
        <div class="terminal-body">
          <span class="terminal-prompt">$</span> <span class="terminal-command">/athanor quality</span>
          <div class="terminal-output">
            <span class="terminal-highlight">━━━ 品質レポート ━━━</span><br>
            対象: ep003.md<br>
            <br>
            coherence:          <span style="color:#4ade80">0.82</span> ████████░░<br>
            pacing:             <span style="color:#fbbf24">0.65</span> ██████░░░░<br>
            prose:              <span style="color:#4ade80">0.78</span> ███████░░░<br>
            character_score:    <span style="color:#4ade80">0.75</span> ███████░░░<br>
            style:              <span style="color:#4ade80">0.80</span> ████████░░<br>
            <br>
            総合: <span class="terminal-success">0.76 (良好)</span><br>
            <br>
            <span style="color:#fbbf24">改善提案:</span><br>
            ・第3段落のテンポが遅い → 対話形式を検討
          </div>
        </div>
      </div>
    </section>

    <!-- Slide 8: Resume Command -->
    <section class="slide" data-slide="8">
      <h2>中断と再開</h2>
      <p><code>/resume</code> で前回の作業から再開</p>

      <div class="content-split">
        <div>
          <div class="terminal">
            <div class="terminal-header">
              <div class="terminal-dot red"></div>
              <div class="terminal-dot yellow"></div>
              <div class="terminal-dot green"></div>
              <span class="terminal-title">再開コマンド</span>
            </div>
            <div class="terminal-body">
              <span class="terminal-prompt">$</span> <span class="terminal-command">/resume</span>
              <div class="terminal-output">
                <span class="terminal-highlight">中断状態が見つかりました:</span><br>
                ・タスク: draft-scene-ep010<br>
                ・段階: quality_check<br>
                ・最終更新: 2026-01-24 10:30<br>
                <br>
                再開しますか? (y/n)
              </div>
            </div>
          </div>
        </div>
        <div>
          <div class="card">
            <h3>いつ使う？</h3>
            <ul>
              <li>作業途中でセッションを終了した</li>
              <li>PCを再起動した</li>
              <li>エラーで中断された</li>
            </ul>
          </div>
          <div class="card" style="margin-top:1rem">
            <h3>状態は自動保存</h3>
            <p>作業状態は <code>.claude/states/</code> に自動保存されます。</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Slide 9: Rollback Command -->
    <section class="slide" data-slide="9">
      <h2>ロールバック</h2>
      <p><code>/athanor rollback</code> で問題発生時に復旧</p>

      <div class="terminal">
        <div class="terminal-header">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <span class="terminal-title">ロールバックの例</span>
        </div>
        <div class="terminal-body">
          <span class="terminal-prompt">$</span> <span class="terminal-command">/athanor rollback</span>
          <div class="terminal-output">
            <span class="terminal-highlight">直前のチェックポイント:</span><br>
            ・コミット: abc1234<br>
            ・日時: 2026-01-24 10:00<br>
            ・メッセージ: [auto] checkpoint before draft<br>
            <br>
            このコミットにリセットしますか? (y/n)
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:2rem">
        <h3>チェックポイントとは？</h3>
        <p>作業開始時に自動で作成されるGitコミットです。<br>
        問題が起きても、この時点に戻れます。</p>
        <p style="margin-top:1rem;color:var(--status-warning)">
          ⚠️ ロールバックすると、その後の変更は失われます
        </p>
      </div>
    </section>

    <!-- Slide 10: Obsidian Integration -->
    <section class="slide" data-slide="10">
      <h2>Obsidian連携</h2>
      <p>Vault構造とファイル管理</p>

      <div class="content-split">
        <div class="vault-tree">
          <span class="folder">vault/作品名/</span><br>
          ├── <span class="folder">episodes/</span> <span class="comment"># 本文</span><br>
          │   ├── ep001.md<br>
          │   └── ep002.md<br>
          ├── <span class="folder">characters/</span> <span class="comment"># キャラ設定</span><br>
          ├── <span class="folder">world/</span> <span class="comment"># 世界観</span><br>
          ├── <span class="folder">_plot/</span> <span class="comment"># プロット</span><br>
          │   ├── L1_theme.md<br>
          │   ├── L2_chapters.md<br>
          │   └── L3_scenes.md<br>
          ├── <span class="folder">_foreshadowing/</span> <span class="comment"># 伏線</span><br>
          ├── <span class="folder">_ai_control/</span> <span class="comment"># AI制御</span><br>
          └── <span class="folder">_settings/</span> <span class="comment"># 作品設定</span>
        </div>
        <div>
          <div class="card">
            <h3>Obsidian での操作</h3>
            <ul>
              <li>設定ファイルの直接編集</li>
              <li>リンクでファイル間を移動</li>
              <li>グラフビューで関係を可視化</li>
            </ul>
          </div>
          <div class="card" style="margin-top:1rem">
            <h3>_ で始まるフォルダ</h3>
            <p>システム用のフォルダです。<br>
            直接編集しても構いませんが、<br>
            フォーマットを守ってください。</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Slide 11: Troubleshooting -->
    <section class="slide" data-slide="11">
      <h2>トラブルシューティング</h2>
      <p>よくある問題と対処法</p>

      <div class="trouble-item">
        <div class="trouble-q">❓ コマンドが反応しない</div>
        <div class="trouble-a">
          → Claude Code が正しく起動しているか確認<br>
          → プロジェクトディレクトリにいるか確認
        </div>
      </div>

      <div class="trouble-item">
        <div class="trouble-q">❓ 「フェーズ警告」が表示される</div>
        <div class="trouble-a">
          → 現在のフェーズで許可されていない操作です<br>
          → <code>/planning</code> や <code>/building</code> でフェーズを切り替え
        </div>
      </div>

      <div class="trouble-item">
        <div class="trouble-q">❓ 下書きがうまく生成されない</div>
        <div class="trouble-a">
          → 必要な設定ファイル（キャラ、プロット等）があるか確認<br>
          → 伏線アラートを確認して対応
        </div>
      </div>

      <div class="trouble-item">
        <div class="trouble-q">❓ データが壊れた気がする</div>
        <div class="trouble-a">
          → <code>/athanor rollback</code> でチェックポイントに復旧<br>
          → それでもダメなら Git で手動復旧
        </div>
      </div>
    </section>

    <!-- Slide 12: Quick Reference -->
    <section class="slide" data-slide="12">
      <h2>コマンド一覧</h2>
      <p>クイックリファレンス</p>

      <table>
        <tr>
          <th>コマンド</th>
          <th>説明</th>
          <th>フェーズ</th>
        </tr>
        <tr>
          <td><code>/planning</code></td>
          <td>PLANNINGフェーズ開始</td>
          <td>Any</td>
        </tr>
        <tr>
          <td><code>/building</code></td>
          <td>BUILDINGフェーズ開始</td>
          <td>Any</td>
        </tr>
        <tr>
          <td><code>/auditing</code></td>
          <td>AUDITINGフェーズ開始</td>
          <td>Any</td>
        </tr>
        <tr>
          <td><code>/athanor draft</code></td>
          <td>下書き生成（The Relay）</td>
          <td>BUILDING</td>
        </tr>
        <tr>
          <td><code>/athanor status</code></td>
          <td>伏線ダッシュボード</td>
          <td>Any</td>
        </tr>
        <tr>
          <td><code>/athanor quality</code></td>
          <td>品質レポート</td>
          <td>BUILDING/AUDITING</td>
        </tr>
        <tr>
          <td><code>/resume</code></td>
          <td>中断状態から再開</td>
          <td>Any</td>
        </tr>
        <tr>
          <td><code>/athanor rollback</code></td>
          <td>チェックポイント復旧</td>
          <td>Any</td>
        </tr>
        <tr>
          <td><code>/athanor switch {名}</code></td>
          <td>作品切り替え</td>
          <td>Any</td>
        </tr>
      </table>
    </section>

  </div>

  <!-- Navigation -->
  <nav class="nav">
    <button class="nav-btn" id="prev-btn" aria-label="前のスライド">←</button>
    <span class="nav-counter"><span id="current-slide">1</span> / <span id="total-slides">12</span></span>
    <button class="nav-btn" id="next-btn" aria-label="次のスライド">→</button>
  </nav>

  <!-- Slide Indicators -->
  <div class="indicators" id="indicators"></div>

  <script>
    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;
    let currentSlide = 1;

    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const currentSlideSpan = document.getElementById('current-slide');
    const totalSlidesSpan = document.getElementById('total-slides');
    const indicatorsContainer = document.getElementById('indicators');

    totalSlidesSpan.textContent = totalSlides;

    for (let i = 1; i <= totalSlides; i++) {
      const indicator = document.createElement('div');
      indicator.className = 'indicator' + (i === 1 ? ' active' : '');
      indicator.dataset.slide = i;
      indicator.addEventListener('click', () => goToSlide(i));
      indicatorsContainer.appendChild(indicator);
    }

    function updateSlide() {
      slides.forEach((slide, index) => {
        slide.classList.toggle('active', index + 1 === currentSlide);
      });
      document.querySelectorAll('.indicator').forEach((ind, index) => {
        ind.classList.toggle('active', index + 1 === currentSlide);
      });
      currentSlideSpan.textContent = currentSlide;
      prevBtn.disabled = currentSlide === 1;
      nextBtn.disabled = currentSlide === totalSlides;
    }

    function goToSlide(n) {
      currentSlide = Math.max(1, Math.min(n, totalSlides));
      updateSlide();
    }

    function nextSlide() {
      if (currentSlide < totalSlides) { currentSlide++; updateSlide(); }
    }

    function prevSlide() {
      if (currentSlide > 1) { currentSlide--; updateSlide(); }
    }

    prevBtn.addEventListener('click', prevSlide);
    nextBtn.addEventListener('click', nextSlide);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
      else if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
      else if (e.key === 'Home') { e.preventDefault(); goToSlide(1); }
      else if (e.key === 'End') { e.preventDefault(); goToSlide(totalSlides); }
    });

    let touchStartX = 0;
    document.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; });
    document.addEventListener('touchend', (e) => {
      const diff = touchStartX - e.changedTouches[0].screenX;
      if (Math.abs(diff) > 50) { diff > 0 ? nextSlide() : prevSlide(); }
    });
  </script>
</body>
</html>
