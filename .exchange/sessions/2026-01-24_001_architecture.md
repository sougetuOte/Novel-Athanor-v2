# 小説生成システム解析依頼

## Meta

| 項目 | 値 |
|------|-----|
| Session ID | 2026-01-24_001 |
| 日時 | 2026-01-24 |
| 依頼元 | claude-code |
| 種別 | architecture |
| Status | open |

---

## 対象範囲 (Scope)

**対象**:
- `docs/Novel-Athanor-main/` - Claude Code統合の小説執筆支援システム
- `docs/NovelWriter-main/` - Pythonマルチエージェント自動生成システム
- `docs/302_novel_writing-main/` - Next.js WebベースAI執筆支援ツール

**背景・コンテキスト**:

「Auto-Novel-Athanor」プロジェクトとして、上記3つの既存システムの長所を統合し、新しい半自動小説生成システムを設計しています。特に**伏線管理**と**AI情報制御**を核心機能として新規開発する予定です。

Claude Codeによる解析（Phase 1-3）を完了し、以下の知見を得ました。今回、異なるAI視点からの解析を依頼し、バイアス補正と見落とし発見を目的としています。

---

## Claude Code による解析知見（共有情報）

### 発見した重要要件

**最重要要件: AI情報制御**

ユーザーフィードバックより発見した核心課題：
> 「隠し設定とかに関しては読者に対する隠しもあるけれども、AIがそれを知ったことによって文章に混ぜてしまうことを一番恐れている。AIは設定を知るとそれをすぐ使おうとしてしまう」

これにより以下の2つの問題を特定：
1. **AIは設定を知ると「使いたがる」** - 伏線を張る前にネタバレしてしまう
2. **AIは設定を「そのまま書いてしまう」** - 匂わせるべきところを説明してしまう

### 各システムの評価

#### Novel-Athanor
| 観点 | 評価 | 詳細 |
|-----|------|------|
| 強み | L1/L2/L3階層 | Plot/Summary の3層構造で計画と実績を管理 |
| 強み | フェーズ管理 | キャラクター/世界観の時系列状態管理 |
| 強み | 隠し設定 | `## 隠し設定`セクションで部分的なAI制御 |
| 弱み | 品質管理 | 自動スコアリングなし |
| 弱み | 整合性追跡 | 自動検証機能が弱い |
| 弱み | 伏線管理 | 表形式の記録のみ、追跡機能なし |

#### NovelWriter
| 観点 | 評価 | 詳細 |
|-----|------|------|
| 強み | マルチエージェント | QualityControl, Consistency, Review等の分離 |
| 強み | 品質スコアリング | coherence, pacing, prose等の自動評価 |
| 強み | 整合性追跡 | CharacterState, WorldElement, PlotThread管理 |
| 弱み | 全自動志向 | 人間介入ポイントが少ない |
| 弱み | 伏線概念なし | PlotThreadはあるが「張り」「回収」概念なし |
| 弱み | AI情報制御なし | 設定の可視性制御機能なし |

#### 302_novel_writing
| 観点 | 評価 | 詳細 |
|-----|------|------|
| 強み | 多言語プロンプト | 中/英/日の最適化されたプロンプト |
| 強み | スタイルテンプレート | サンプルベースの文体指定 |
| 強み | ストリーミングUI | リアルタイム生成表示 |
| 弱み | 単純なデータモデル | 階層構造なし |
| 弱み | 検証機能なし | 品質・整合性の自動チェックなし |
| 弱み | 伏線管理なし | 概念自体が存在しない |

### 設計方針（暫定）

1. **Novel-Athanorベース**: L1/L2/L3、フェーズ管理、人間主導の対話性を維持
2. **NovelWriterから導入**: 品質スコアリング、整合性追跡、エージェント分離
3. **302_novel_writingから導入**: 構造化プロンプト、スタイルテンプレート
4. **新規開発**: AI情報制御システム、伏線管理システム

---

## 依頼内容 (Request)

以下の観点で3プロジェクトを解析し、Claude Codeの解析結果と比較・補完してください。

### 1. アーキテクチャ観点

| 確認事項 | 詳細 |
|----------|------|
| 全体構造 | ディレクトリ構成、モジュール分割、依存関係 |
| データフロー | 入力 → 処理 → 出力の流れ |
| 拡張性 | 新機能追加のしやすさ、プラグイン機構の有無 |
| 技術スタック | 言語、フレームワーク、外部ライブラリの選定理由 |

**質問**:
- Claude Codeの評価と異なる点はありますか？
- 各システムのアーキテクチャ上の隠れた長所/短所はありますか？

### 2. データモデル観点

| 確認事項 | 詳細 |
|----------|------|
| エンティティ | 主要なデータ構造（キャラクター、世界観、プロット等） |
| 関係性 | エンティティ間の関連（1対多、多対多） |
| 永続化 | データの保存形式（JSON、Markdown、DB等） |
| バージョン管理 | 状態変化の追跡方法 |

**質問**:
- Novel-AthanorのL1/L2/L3階層についてどう評価しますか？
- NovelWriterのCharacterState/WorldElement/PlotThread構造の設計品質は？
- 統合時に注意すべきデータモデルの非互換性はありますか？

### 3. 機能フロー観点

| 確認事項 | 詳細 |
|----------|------|
| ユーザーインタラクション | 入力方法、UI/UX |
| 生成プロセス | AI呼び出しのタイミング、プロンプト設計 |
| 品質管理 | 整合性チェック、レビュー機能 |
| 出力形式 | 生成物のフォーマット |

**質問**:
- 各システムの生成フローで最も優れている点は何ですか？
- 302_novel_writingのプロンプト設計は他システムと比較してどうですか？

### 4. 伏線管理観点（新システム向け重点項目）

| 確認事項 | 詳細 |
|----------|------|
| 伏線の定義 | 伏線をどう構造化しているか |
| 発生と回収 | 伏線の登場・解決の追跡方法 |
| 情報階層 | 読者/書き手/AIの情報アクセス制御 |
| 整合性 | 伏線の矛盾検出機能 |

**質問**:
- 3システムに伏線管理に「近い」機能はありますか？Claude Codeは「ほぼない」と判断しましたが、見落としはありませんか？
- Novel-Athanorの`## 隠し設定`セクションの実装をどう評価しますか？
- 伏線管理システムを新規設計する場合、参考にすべき既存の設計パターンはありますか？

### 5. AI情報制御観点（最重要・新規要件）

Claude Codeが提案した4段階可視性レベル：

| Level | 名称 | AIの認識 | AIの行動 |
|-------|------|---------|---------|
| 0 | 完全秘匿 | 存在すら知らない | 何も書けない |
| 1 | 認識のみ | 「何かある」と知る | 内容には触れない |
| 2 | 内容認識 | 内容を知っている | 文章には出さない |
| 3 | 使用可能 | 完全に把握 | 文章で使ってよい |

**質問**:
- この4段階モデルに対する評価・改善提案はありますか？
- 3システムにAI情報制御に関連する実装はありますか？
- 「AIが設定をそのまま書いてしまう」問題に対する他のアプローチはありますか？

### 6. パフォーマンス・スケーラビリティ観点

| 確認事項 | 詳細 |
|----------|------|
| 大規模作品対応 | 100話以上の長編小説での動作 |
| 処理速度 | 生成・検索・整合性チェックの速度 |
| リソース消費 | メモリ、API呼び出し回数 |
| 並列処理 | 複数エージェントの同時実行 |

**質問**:
- 各システムは大規模作品（100話以上）に対応できる設計ですか？
- ボトルネックになりそうな箇所はどこですか？
- NovelWriterのマルチエージェント構成はスケーラビリティの観点でどう評価しますか？

### 7. メンテナンス性・学習コスト観点

| 確認事項 | 詳細 |
|----------|------|
| コード品質 | 可読性、ドキュメント、テストカバレッジ |
| 拡張容易性 | 新機能追加時の影響範囲 |
| 学習コスト | 新規参入者が理解するまでの時間 |
| 依存関係 | 外部ライブラリへの依存度 |

**質問**:
- 最もメンテナンスしやすい設計はどのシステムですか？
- 各システムの技術的負債（Technical Debt）はどの程度ですか？
- 新システム設計時に避けるべきアンチパターンは見られますか？

### 8. 新システム設計への提言

上記の解析を踏まえて、以下について提言してください：

1. **採用すべき要素**: 各システムから何を採用すべきか
2. **避けるべき要素**: 採用を避けるべき設計・実装は何か
3. **統合時の課題**: 異なるシステムの長所を統合する際の技術的課題
4. **新規開発の優先順位**: AI情報制御と伏線管理、どちらを先に実装すべきか
5. **アーキテクチャ推奨**: 新システムの推奨アーキテクチャ構成

---

## 添付・参考情報 (Attachments)

### 参照すべき主要ファイル

#### Novel-Athanor
- `docs/Novel-Athanor-main/CLAUDE.md` - システム概要、機能一覧
- `docs/Novel-Athanor-main/vault/templates/` - データテンプレート
- `docs/Novel-Athanor-main/.claude/agents/` - エージェント定義
- `docs/Novel-Athanor-main/.claude/skills/` - 知識ベース

#### NovelWriter
- `docs/NovelWriter-main/README.md` - システム概要
- `docs/NovelWriter-main/agents/` - エージェント実装
- `docs/NovelWriter-main/core/generation/` - 生成ロジック
- `docs/NovelWriter-main/core/config/genre_configs/` - ジャンル設定

#### 302_novel_writing
- `docs/302_novel_writing-main/README.md` - システム概要
- `docs/302_novel_writing-main/src/app/[locale]/[id]/components/rightMenu/AIWriting/` - AI執筆機能
- `docs/302_novel_writing-main/src/constants/novelStyleType/` - スタイル設定

### Claude Code 解析レポート（参考）

以下のレポートをClaude Codeが作成済みです。比較参照してください：

- `docs/specs/novel-generator/analysis-novel-athanor-architecture.md`
- `docs/specs/novel-generator/analysis-novel-athanor-datamodel.md`
- `docs/specs/novel-generator/analysis-novel-athanor-functionflow.md`
- `docs/specs/novel-generator/analysis-novelwriter-architecture.md`
- `docs/specs/novel-generator/analysis-302-novel-writing.md`
- `docs/specs/novel-generator/analysis-crossreview.md`
- `docs/memos/2026-01-24_ai-information-control.md`

---

## 回答形式の希望

以下の形式で回答をお願いします：

```markdown
## 1. アーキテクチャ観点

### 1.1 Novel-Athanor
[評価と詳細]

### 1.2 NovelWriter
[評価と詳細]

### 1.3 302_novel_writing
[評価と詳細]

### 1.4 Claude Codeとの差異
[Claude Codeの解析と異なる点、補完すべき点]

## 2. データモデル観点
[同様の形式]

...

## 8. 新システム設計への提言

### 8.1 採用すべき要素
[具体的な提言]

### 8.2 避けるべき要素
[具体的な提言]

### 8.3 統合時の課題
[技術的課題のリスト]

### 8.4 新規開発の優先順位
[推奨順序と理由]

### 8.5 アーキテクチャ推奨
[推奨構成図と説明]
```

---

<!-- 回答は以下に追記してください -->
