# プロジェクト自己改造ルール

## Purpose

Novel-Athanor-v2 プロジェクト自体の構成変更（メタ改造）に適用するルール。
通常の機能開発とは異なり、フレームワーク自体の変更は慎重に行う必要がある。

## 計画優先原則

プロジェクト構成の改造・修正は、**コーディング前に必ず計画を立てる**。

### 適用フロー

```
1. 現状分析
   └─ 何が問題か、何を変えたいかを明確化

2. 変更計画の策定
   └─ どう変えるか、影響範囲はどこか

3. ユーザー承認
   └─ 計画をユーザーに提示し、承認を得る

4. ADR 作成（重要な決定の場合）
   └─ docs/adr/ に決定記録を残す

5. 設計ドキュメント更新
   └─ docs/internal/ や .claude/rules/ を更新

6. 実際のファイル変更
   └─ 承認された計画に基づいて実行
```

### 適用条件

以下の変更には本ルールを適用する：

| 対象 | 例 |
|------|-----|
| `.claude/rules/` | ガードレールの追加・修正 |
| `.claude/agents/` | サブエージェントの追加・修正 |
| `.claude/commands/` | スラッシュコマンドの追加・修正 |
| `CLAUDE.md` | プロジェクト憲法の変更 |
| `docs/internal/` | プロセス定義の変更 |
| ディレクトリ構造 | 新規ディレクトリの追加、構造変更 |
| 状態管理方式 | `.claude/states/` の形式変更 |

### 例外

以下は即時実行可能：

- Typo 修正
- 明らかなバグ修正
- コメントの追加・修正
- 既存ルールに基づく通常の成果物作成

## 理由

1. **整合性維持**: フレームワーク変更は全体に波及する
2. **追跡可能性**: 変更の意図と経緯を記録する
3. **ユーザー主権**: プロジェクトオーナーの意思を尊重する

## 違反時の対応

計画なしにプロジェクト構成を変更しようとした場合：

```
⚠️ 自己改造警告

プロジェクト構成の変更には計画優先原則が適用されます。

1. 現状分析と変更計画を提示
2. ユーザー承認を取得
3. その後に実行

変更内容: [変更しようとした内容]
```

## 参照

- `CLAUDE.md`: プロジェクト憲法
- `docs/internal/06_DECISION_MAKING.md`: 意思決定プロトコル
- `docs/specs/novel-generator/analysis-plan.md`: 解析計画書 Section 8
