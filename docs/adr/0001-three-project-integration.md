# ADR-0001: 3プロジェクト統合方針

## メタ情報
| 項目 | 内容 |
|------|------|
| ステータス | Accepted |
| 日付 | 2026-01-24 |
| 意思決定者 | プロジェクトオーナー |
| 関連ADR | - |

## コンテキスト

### 背景
小説執筆支援システムを構築するにあたり、既存の3つのプロジェクトを解析し、それぞれの長所を活かした新システムを設計する必要があった。

### 解析対象プロジェクト

| プロジェクト | 出典 | 特徴 |
|-------------|------|------|
| Novel-Athanor | ユーザー作 | 設定管理、フェーズ管理、Obsidian統合 |
| NovelWriter | GitHub (EdwardAThomson) | マルチエージェント、完全自動生成 |
| 302_novel_writing | GitHub (302ai) | Web UI、多言語対応、API統合 |

### 制約条件
- Claude Code (CLI) を実行環境とする
- Obsidian との互換性を維持
- ユーザーの創作意図を尊重する設計

### 要求事項
- 各プロジェクトの長所を最大限活用
- 既存プロジェクトにない「伏線管理」機能を追加
- 完全自動ではなく、ユーザー協調型のワークフロー

## 検討した選択肢

### Option A: Novel-Athanor ベースで拡張
**概要**: ユーザー作の Novel-Athanor をベースに、他2プロジェクトの機能を追加

**メリット**:
- ユーザーの設計思想を継承
- Obsidian 統合が既に確立

**デメリット**:
- マルチエージェント機能の大規模追加が必要
- 既存コードのリファクタリング負担

### Option B: NovelWriter ベースで拡張
**概要**: NovelWriter のエージェントシステムをベースに拡張

**メリット**:
- マルチエージェント機能が成熟
- 完全自動生成の実績

**デメリット**:
- ユーザー介入ポイントの設計が困難
- Obsidian 統合の追加開発が必要

### Option C: 新規設計（3プロジェクト統合）
**概要**: 3プロジェクトを解析し、長所を抽出した新規アーキテクチャを設計

**メリット**:
- 各プロジェクトの最良部分を採用可能
- 技術的負債なしでスタート
- 新規機能（伏線管理）を最初から設計に組み込み

**デメリット**:
- 開発期間が長くなる可能性
- 設計の複雑さ

## 3 Agents Analysis

### [Affirmative] 推進者の視点
> 最高の結果はどうなるか？どうすれば実現できるか？

- 各プロジェクトの「いいとこ取り」で最強のシステムが作れる
- Novel-Athanor の設定管理 + NovelWriter のエージェント + 302 の UI 思想
- 新規設計なら伏線管理を中核機能として組み込める
- 将来の拡張性も考慮した設計が可能

### [Critical] 批判者の視点
> 最悪の場合どうなるか？何が壊れるか？

- 「いいとこ取り」のつもりが機能過多で破綻するリスク
- 3プロジェクトの設計思想が衝突する可能性
- 開発スコープの肥大化
- 完成までの時間が読めない

### [Mediator] 調停者の視点
> 今、我々が取るべき最善のバランスは何か？

- Option C（新規設計）を採用するが、スコープを明確に限定
- 優先順位: 伏線管理 > AI情報制御 > 設定管理 > 自動生成
- 段階的リリース（MVP → 機能追加）で複雑さを管理
- 仕様書を先に確定し、実装前に全体像を固める

## 決定

**採用**: Option C（新規設計・3プロジェクト統合）

### 決定理由
- ユーザーの要望である「伏線管理」を中核に据えるには新規設計が最適
- 既存コードの制約を受けずに、理想的なアーキテクチャを設計可能
- 仕様策定フェーズで十分な検討時間を確保

### 却下理由
- **Option A**: Novel-Athanor ベースではエージェント追加の負担が大きい
- **Option B**: NovelWriter は完全自動志向で、ユーザー協調の思想と合わない

## 影響

### ポジティブな影響
- 技術的負債のないクリーンなコードベース
- 各プロジェクトの長所を最大限活用
- 伏線管理を中核機能として設計

### ネガティブな影響
- 開発期間が長くなる（緩和策: 仕様策定を先行し、実装リスクを低減）
- 既存コードの再利用が限定的（緩和策: 設計思想とパターンを参考に）

### 影響を受けるコンポーネント
- `docs/specs/novel-generator-v2/`: 統合仕様書として策定完了
- `src/`: 新規実装（未着手）

## 実装計画

### フェーズ1: 仕様策定 ✅
- [x] 3プロジェクト解析
- [x] 統合仕様書作成（00-09）
- [x] Antigravity レビュー

### フェーズ2: 実装準備
- [ ] 開発環境セットアップ
- [ ] タスク分解

### フェーズ3: 実装
- [ ] コアモジュール実装
- [ ] エージェント実装
- [ ] テスト

## 検証方法
- 仕様書レビュー完了（Antigravity による検証済み）
- 実装後のユーザーテストで「協調的創作」が実現できているか確認

## 参考資料
- `docs/specs/novel-generator/analysis-*.md`: 各プロジェクト解析結果
- `docs/specs/novel-generator-v2/00_overview.md`: 統合仕様概要
- `docs/memo/最初の思いつき.md`: プロジェクト構想
